<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>클릭 게임 + 카트늅바보</title>
<style>
  body {
    font-family: sans-serif;
    background: #000;
    color: white;
    text-align: center;
    margin: 0;
    padding: 0;
    overflow: hidden;
  }
  h1 {
    margin-top: 20px;
    position: relative;
    z-index: 10;
  }
  #money {
    font-size: 24px;
    margin-bottom: 20px;
    position: relative;
    z-index: 10;
  }
  #click-btn {
    font-size: 20px;
    padding: 20px 40px;
    cursor: pointer;
    background: #4CAF50;
    color: white;
    border: none;
    border-radius: 10px;
    transition: background 0.2s;
    position: relative;
    z-index: 10;
  }
  #click-btn:hover {
    background: #45a049;
  }
  .shop {
    margin-top: 20px;
    display: flex;
    justify-content: center;
    gap: 20px;
    position: relative;
    z-index: 10;
  }
  .item {
    background: #222;
    padding: 15px;
    border-radius: 10px;
    box-shadow: 0 0 5px rgba(255,255,255,0.2);
    width: 200px;
  }
  .item button {
    padding: 10px;
    border: none;
    border-radius: 5px;
    background: #2196F3;
    color: white;
    cursor: pointer;
    margin-top: 10px;
  }
  .item button:disabled {
    background: gray;
    cursor: not-allowed;
  }
  canvas {
    position: fixed;
    top: 0;
    left: 0;
    z-index: -1; /* 배경 뒤로 보내기 */
  }
</style>
</head>
<body>
  <h1>클릭 게임</h1>
  <div id="money">돈: 0원</div>
  <button id="click-btn">클릭!</button>

  <div class="shop">
    <div class="item">
      <h3>카트늅바보</h3>
      <p id="kart-lv">레벨: 0</p>
      <p id="kart-cost">가격: 1원</p>
      <button id="buy-kart">구매</button>
    </div>
    <div class="item">
      <h3>클릭당 돈 증가</h3>
      <p id="click-lv">레벨: 0</p>
      <p id="click-cost">가격: 5원</p>
      <button id="buy-click">구매</button>
    </div>
  </div>

  <canvas id="kartCanvas"></canvas>

<script>
  let money = 0;
  let clickValue = 1;

  // 카트늅바보 업그레이드
  let kartLevel = 0;
  let kartCost = 1;

  // 클릭당 돈 증가 업그레이드
  let clickLevel = 0;
  let clickCost = 5;

  const moneyDisplay = document.getElementById("money");
  const clickBtn = document.getElementById("click-btn");
  const kartLvDisplay = document.getElementById("kart-lv");
  const kartCostDisplay = document.getElementById("kart-cost");
  const clickLvDisplay = document.getElementById("click-lv");
  const clickCostDisplay = document.getElementById("click-cost");

  const buyKartBtn = document.getElementById("buy-kart");
  const buyClickBtn = document.getElementById("buy-click");

  // 캔버스 설정
  const canvas = document.getElementById("kartCanvas");
  const ctx = canvas.getContext("2d");
  let W = window.innerWidth;
  let H = window.innerHeight;
  canvas.width = W;
  canvas.height = H;

  window.addEventListener("resize", () => {
    W = window.innerWidth;
    H = window.innerHeight;
    canvas.width = W;
    canvas.height = H;
  });

  // 카트늅 객체 배열
  let kartList = [];

  function createKart() {
    let speed = Math.random() * 2 + 1;
    kartList.push({
      x: Math.random() * W,
      y: Math.random() * H,
      dx: (Math.random() < 0.5 ? -1 : 1) * speed,
      dy: (Math.random() < 0.5 ? -1 : 1) * speed,
      color: randomColor()
    });
  }

  function randomColor() {
    return `hsl(${Math.random()*360}, 100%, 50%)`;
  }

  function updateDisplay() {
    moneyDisplay.textContent = `돈: ${money}원`;
    kartLvDisplay.textContent = `레벨: ${kartLevel}`;
    kartCostDisplay.textContent = `가격: ${kartCost}원`;
    clickLvDisplay.textContent = `레벨: ${clickLevel}`;
    clickCostDisplay.textContent = `가격: ${clickCost}원`;

    buyKartBtn.disabled = money < kartCost;
    buyClickBtn.disabled = money < clickCost;
  }

  clickBtn.addEventListener("click", () => {
    money += clickValue;
    updateDisplay();
  });

  buyKartBtn.addEventListener("click", () => {
    if (money >= kartCost) {
      money -= kartCost;
      kartLevel++;
      kartCost *= 2; // 가격 2배씩
      createKart();
      updateDisplay();
    }
  });

  buyClickBtn.addEventListener("click", () => {
    if (money >= clickCost) {
      money -= clickCost;
      clickLevel++;
      clickValue++;
      clickCost *= 2; // 가격 2배씩
      updateDisplay();
    }
  });

  // 카트늅 움직임
  function animate() {
    ctx.clearRect(0, 0, W, H);
    ctx.font = "20px Arial";
    ctx.textBaseline = "top";

    for (let kart of kartList) {
      kart.x += kart.dx;
      kart.y += kart.dy;

      // 색 계속 바꾸기
      kart.color = randomColor();

      // 벽 부딪힘 체크
      if (kart.x <= 0 || kart.x + 60 >= W) {
        kart.dx *= -1;
        money += kartLevel; // 업그레이드 레벨 비례 수익
      }
      if (kart.y <= 0 || kart.y + 20 >= H) {
        kart.dy *= -1;
        money += kartLevel;
      }

      ctx.fillStyle = kart.color;
      ctx.fillText("카트늅", kart.x, kart.y);
    }

    updateDisplay();
    requestAnimationFrame(animate);
  }

  animate();
  updateDisplay();
</script>
</body>
</html>
